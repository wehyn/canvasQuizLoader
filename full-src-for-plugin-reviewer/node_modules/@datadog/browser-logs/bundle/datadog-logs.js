(()=>{"use strict";const e={log:"log",debug:"debug",info:"info",warn:"warn",error:"error"},t=console,n={};Object.keys(e).forEach((e=>{n[e]=t[e]}));const o="Datadog Browser SDK:",r={debug:n.debug.bind(t,o),log:n.log.bind(t,o),info:n.info.bind(t,o),warn:n.warn.bind(t,o),error:n.error.bind(t,o)},s="https://docs.datadoghq.com",i=`${s}/real_user_monitoring/browser/troubleshooting`,a="More details:";function c(e,t){return(...n)=>{try{return e(...n)}catch(e){r.error(t,e)}}}let u,l=!1;function d(e){l=e}function f(e){return function(){return p(e,this,arguments)}}function p(e,t,n){try{return e.apply(t,n)}catch(e){!function(e){if(g(e),u)try{u(e)}catch(e){g(e)}}(e)}}function g(...e){l&&r.error("[MONITOR]",...e)}function m(){if("object"==typeof globalThis)return globalThis;Object.defineProperty(Object.prototype,"_dd_temp_",{get(){return this},configurable:!0});let e=_dd_temp_;return delete Object.prototype._dd_temp_,"object"!=typeof e&&(e="object"==typeof self?self:"object"==typeof window?window:{}),e}const y=1024,h=/[^\u0000-\u007F]/;function b(e){return h.test(e)?void 0!==window.TextEncoder?(new TextEncoder).encode(e).length:new Blob([e]).size:e.length}function v(e,t){const n=m();let o;return n.Zone&&"function"==typeof n.Zone.__symbol__&&(o=e[n.Zone.__symbol__(t)]),o||(o=e[t]),o}function w(e,t){return v(m(),"setTimeout")(f(e),t)}function S(e){v(m(),"clearTimeout")(e)}function k(e,t){return v(m(),"setInterval")(f(e),t)}function x(e){v(m(),"clearInterval")(e)}function C(e,t,n){const o=!n||void 0===n.leading||n.leading,r=!n||void 0===n.trailing||n.trailing;let s,i,a=!1;return{throttled:(...n)=>{a?s=n:(o?e(...n):s=n,a=!0,i=w((()=>{r&&s&&e(...s),a=!1,s=void 0}),t))},cancel:()=>{S(i),a=!1,s=void 0}}}function _(){}function E(e,t,n){if("object"!=typeof e||null===e)return JSON.stringify(e);const o=T(Object.prototype),r=T(Array.prototype),s=T(Object.getPrototypeOf(e)),i=T(e);try{return JSON.stringify(e,t,n)}catch(e){return"<error: unable to serialize object>"}finally{o(),r(),s(),i()}}function T(e){const t=e,n=t.toJSON;return n?(delete t.toJSON,()=>{t.toJSON=n}):_}function $(e,t){return Object.keys(e).some((n=>e[n]===t))}function R(e){return 0===Object.keys(e).length}function O(e=2){const t=new Map;let n=!1;function o(o=0){if(n||0===e)return;const s=2===e?3072:16384;let c=o;t.forEach((e=>{c+=e.getBytesCount()})),c>s&&(!function(e){r.warn(`Customer data exceeds the recommended ${e/y}KiB threshold. ${a} ${i}/#customer-data-exceeds-the-recommended-threshold-warning`)}(s),n=!0)}return{createDetachedTracker:()=>{const e=L((()=>o(e.getBytesCount())));return e},getOrCreateTracker:e=>(t.has(e)||t.set(e,L(o)),t.get(e)),setCompressionStatus:t=>{0===e&&(e=t,o())},getCompressionStatus:()=>e,stop:()=>{t.forEach((e=>e.stop())),t.clear()}}}function L(e){let t=0;const{throttled:n,cancel:o}=C((n=>{t=b(E(n)),e()}),200),r=()=>{o(),t=0};return{updateCustomerData:e=>{R(e)?r():n(e)},resetCustomerData:r,getBytesCount:()=>t,stop:()=>{o()}}}function A(e){return null===e?"null":Array.isArray(e)?"array":typeof e}function I(e,t,n=function(){if("undefined"!=typeof WeakSet){const e=new WeakSet;return{hasAlreadyBeenSeen(t){const n=e.has(t);return n||e.add(t),n}}}const e=[];return{hasAlreadyBeenSeen(t){const n=e.indexOf(t)>=0;return n||e.push(t),n}}}()){if(void 0===t)return e;if("object"!=typeof t||null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const e=t.flags||[t.global?"g":"",t.ignoreCase?"i":"",t.multiline?"m":"",t.sticky?"y":"",t.unicode?"u":""].join("");return new RegExp(t.source,e)}if(n.hasAlreadyBeenSeen(t))return;if(Array.isArray(t)){const o=Array.isArray(e)?e:[];for(let e=0;e<t.length;++e)o[e]=I(o[e],t[e],n);return o}const o="object"===A(e)?e:{};for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(o[e]=I(o[e],t[e],n));return o}function P(e){return I(void 0,e)}function D(...e){let t;for(const n of e)null!=n&&(t=I(t,n));return t}function B(e,t=225280){const n=T(Object.prototype),o=T(Array.prototype),r=[],s=new WeakMap,i=q(e,"$",void 0,r,s),a=JSON.stringify(i);let c=a?a.length:0;if(!(c>t)){for(;r.length>0&&c<t;){const n=r.shift();let o=0;if(Array.isArray(n.source))for(let i=0;i<n.source.length;i++){const a=q(n.source[i],n.path,i,r,s);if(c+=void 0!==a?JSON.stringify(a).length:4,c+=o,o=1,c>t){U(t,"truncated",e);break}n.target[i]=a}else for(const i in n.source)if(Object.prototype.hasOwnProperty.call(n.source,i)){const a=q(n.source[i],n.path,i,r,s);if(void 0!==a&&(c+=JSON.stringify(a).length+o+i.length+3,o=1),c>t){U(t,"truncated",e);break}n.target[i]=a}}return n(),o(),i}U(t,"discarded",e)}function q(e,t,n,o,r){const s=function(e){const t=e;if(t&&"function"==typeof t.toJSON)try{return t.toJSON()}catch(e){}return e}(e);if(!s||"object"!=typeof s)return function(e){if("bigint"==typeof e)return`[BigInt] ${e.toString()}`;if("function"==typeof e)return`[Function] ${e.name||"unknown"}`;if("symbol"==typeof e)return`[Symbol] ${e.description||e.toString()}`;return e}(s);const i=M(s);if("[Object]"!==i&&"[Array]"!==i&&"[Error]"!==i)return i;const a=e;if(r.has(a))return`[Reference seen at ${r.get(a)}]`;const c=void 0!==n?`${t}.${n}`:t,u=Array.isArray(s)?[]:{};return r.set(a,c),o.push({source:s,target:u,path:c}),u}function M(e){try{if(e instanceof Event)return{type:(t=e).type,isTrusted:t.isTrusted,currentTarget:t.currentTarget?M(t.currentTarget):null,target:t.target?M(t.target):null};if(e instanceof RegExp)return`[RegExp] ${e.toString()}`;const n=Object.prototype.toString.call(e).match(/\[object (.*)\]/);if(n&&n[1])return`[${n[1]}]`}catch(e){}var t;return"[Unserializable]"}function U(e,t,n){r.warn(`The data provided has been ${t} as it is over the limit of ${e} characters:`,n)}class j{constructor(e){this.onFirstSubscribe=e,this.observers=[]}subscribe(e){return this.observers.push(e),1===this.observers.length&&this.onFirstSubscribe&&(this.onLastUnsubscribe=this.onFirstSubscribe(this)||void 0),{unsubscribe:()=>{this.observers=this.observers.filter((t=>e!==t)),!this.observers.length&&this.onLastUnsubscribe&&this.onLastUnsubscribe()}}}notify(e){this.observers.forEach((t=>t(e)))}}function N(...e){return new j((t=>{const n=e.map((e=>e.subscribe((e=>t.notify(e)))));return()=>n.forEach((e=>e.unsubscribe()))}))}function F(e,t,n){const o={...e};for(const[s,{required:i,type:a}]of Object.entries(t))"string"===a&&s in o&&(o[s]=String(o[s])),i&&!(s in e)&&r.warn(`The property ${s} of ${n} is required; context will not be sent to the intake.`);return o}function H(e="",{customerDataTracker:t,propertiesConfig:n={}}={}){let o={};const s=new j,i={getContext:()=>P(o),setContext:a=>{!function(e){const t="object"===A(e);return t||r.error("Unsupported context:",e),t}(a)?i.clearContext():(o=B(F(a,n,e)),null==t||t.updateCustomerData(o)),s.notify()},setContextProperty:(r,i)=>{o=B(F({...o,[r]:i},n,e)),null==t||t.updateCustomerData(o),s.notify()},removeContextProperty:r=>{delete o[r],null==t||t.updateCustomerData(o),F(o,n,e),s.notify()},clearContext:()=>{o={},null==t||t.resetCustomerData(),s.notify()},changeObservable:s};return i}const G={GRANTED:"granted",NOT_GRANTED:"not-granted"};function z(e,t,n,o,r){return J(e,t,[n],o,r)}function J(e,t,n,o,{once:r,capture:s,passive:i}={}){const a=f((t=>{(t.isTrusted||t.__ddIsTrusted||e.allowUntrustedEvents)&&(r&&d(),o(t))})),c=i?{capture:s,passive:i}:s,u=window.EventTarget&&t instanceof EventTarget?window.EventTarget.prototype:t,l=v(u,"addEventListener");function d(){const e=v(u,"removeEventListener");n.forEach((n=>e.call(t,n,a,c)))}return n.forEach((e=>l.call(t,e,a,c))),{stop:d}}const W="_dd_c",V=[];function X(e,t,n,o){const r=function(e,t){return`${W}_${e}_${t}`}(n,o);V.push(z(e,window,"storage",(({key:e})=>{r===e&&t.setContext(i())}))),t.changeObservable.subscribe((function(){localStorage.setItem(r,JSON.stringify(t.getContext()))}));const s=D(i(),t.getContext());function i(){const e=localStorage.getItem(r);return e?JSON.parse(e):{}}R(s)||t.setContext(s)}const Z="?";function Y(e){const t=[];let n=ie(e,"stack");const o=String(e);return n&&n.startsWith(o)&&(n=n.slice(o.length)),n&&n.split("\n").forEach((e=>{const n=function(e){const t=ee.exec(e);if(!t)return;const n=t[2]&&0===t[2].indexOf("native"),o=t[2]&&0===t[2].indexOf("eval"),r=te.exec(t[2]);o&&r&&(t[2]=r[1],t[3]=r[2],t[4]=r[3]);return{args:n?[t[2]]:[],column:t[4]?+t[4]:void 0,func:t[1]||Z,line:t[3]?+t[3]:void 0,url:n?void 0:t[2]}}(e)||function(e){const t=ne.exec(e);if(!t)return;return{args:[],column:t[3]?+t[3]:void 0,func:Z,line:t[2]?+t[2]:void 0,url:t[1]}}(e)||function(e){const t=oe.exec(e);if(!t)return;return{args:[],column:t[4]?+t[4]:void 0,func:t[1]||Z,line:+t[3],url:t[2]}}(e)||function(e){const t=re.exec(e);if(!t)return;const n=t[3]&&t[3].indexOf(" > eval")>-1,o=se.exec(t[3]);n&&o&&(t[3]=o[1],t[4]=o[2],t[5]=void 0);return{args:t[2]?t[2].split(","):[],column:t[5]?+t[5]:void 0,func:t[1]||Z,line:t[4]?+t[4]:void 0,url:t[3]}}(e);n&&(!n.func&&n.line&&(n.func=Z),t.push(n))})),{message:ie(e,"message"),name:ie(e,"name"),stack:t}}const K="((?:file|https?|blob|chrome-extension|electron|native|eval|webpack|snippet|<anonymous>|\\w+\\.|\\/).*?)",Q="(?::(\\d+))",ee=new RegExp(`^\\s*at (.*?) ?\\(${K}${Q}?${Q}?\\)?\\s*$`,"i"),te=new RegExp(`\\((\\S*)${Q}${Q}\\)`);const ne=new RegExp(`^\\s*at ?${K}${Q}?${Q}??\\s*$`,"i");const oe=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i;const re=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|capacitor|\[native).*?|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,se=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i;function ie(e,t){if("object"!=typeof e||!e||!(t in e))return;const n=e[t];return"string"==typeof n?n:void 0}function ae(e,t,n,o){const r=[{url:t,column:o,line:n}],{name:s,message:i}=function(e){let t,n;"[object String]"==={}.toString.call(e)&&([,t,n]=ce.exec(e));return{name:t,message:n}}(e);return{name:s,message:i,stack:r}}const ce=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?([\s\S]*)$/;function ue(e){const t=new Error(e);let n;return t.name="HandlingStack",p((()=>{const e=Y(t);e.stack=e.stack.slice(2),n=le(e)})),n}function le(e){let t=de(e);return e.stack.forEach((e=>{const n="?"===e.func?"<anonymous>":e.func,o=e.args&&e.args.length>0?`(${e.args.join(", ")})`:"",r=e.line?`:${e.line}`:"",s=e.line&&e.column?`:${e.column}`:"";t+=`\n  at ${n}${o} @ ${e.url}${r}${s}`})),t}function de(e){return`${e.name||"Error"}: ${e.message}`}const fe="No stack, consider using an instance of Error";function pe({stackTrace:e,originalError:t,handlingStack:n,componentStack:o,startClocks:r,nonErrorPrefix:s,source:i,handling:a}){const c=ye(t),u=function(e,t,n,o){return(null==e?void 0:e.message)&&(null==e?void 0:e.name)?e.message:t?"Empty message":`${n} ${E(B(o))}`}(e,c,s,t),l=function(e,t){if(void 0===t)return!1;if(e)return!0;return t.stack.length>0&&(t.stack.length>1||void 0!==t.stack[0].url)}(c,e)?le(e):fe,d=c?he(t,i):void 0;return{startClocks:r,source:i,handling:a,handlingStack:n,componentStack:o,originalError:t,type:e?e.name:void 0,message:u,stack:l,causes:d,fingerprint:ge(t),context:me(t)}}function ge(e){return ye(e)&&"dd_fingerprint"in e?String(e.dd_fingerprint):void 0}function me(e){if(null!==e&&"object"==typeof e&&"dd_context"in e)return e.dd_context}function ye(e){return e instanceof Error||"[object Error]"===Object.prototype.toString.call(e)}function he(e,t){let n=e;const o=[];for(;ye(null==n?void 0:n.cause)&&o.length<10;){const e=Y(n.cause);o.push({message:n.cause.message,source:t,type:null==e?void 0:e.name,stack:e&&le(e)}),n=n.cause}return o.length?o:void 0}var be;!function(e){e.WRITABLE_RESOURCE_GRAPHQL="writable_resource_graphql",e.MISSING_URL_CONTEXT_TELEMETRY="missing_url_context_telemetry"}(be||(be={}));const ve=new Set;function we(e){Array.isArray(e)&&e.filter((e=>$(be,e))).forEach((e=>{ve.add(e)}))}function Se(){return ve}const ke="dd0g-gov.com",xe="datadoghq.com",Ce="pci.browser-intake-datadoghq.com",_e=["ddsource","ddtags"],Ee=1e3,Te=6e4,$e=31536e6;function Re(){return(new Date).getTime()}function Oe(){return Re()}function Le(){return performance.now()}function Ae(){return{relative:Le(),timeStamp:Oe()}}function Ie(e,t){return e+t}function Pe(e){return e-Be()}let De;function Be(){return void 0===De&&(De=performance.timing.navigationStart),De}function qe(e,t){const n=window.__ddBrowserSdkExtensionCallback;n&&n({type:e,payload:t})}function Me(e){return 0!==e&&100*Math.random()<=e}function Ue(){var e;const t=window.navigator;return{status:t.onLine?"connected":"not_connected",interfaces:t.connection&&t.connection.type?[t.connection.type]:void 0,effective_type:null===(e=t.connection)||void 0===e?void 0:e.effectiveType}}function je(e,t){const n=e.indexOf(t);n>=0&&e.splice(n,1)}function Ne(){const e=[];return{add:t=>{e.push(t)>500&&e.splice(0,1)},remove:t=>{je(e,t)},drain:t=>{e.forEach((e=>e(t))),e.length=0}}}const Fe="log",He="configuration",Ge="usage",ze=["https://www.datadoghq-browser-agent.com","https://www.datad0g-browser-agent.com","https://d3uc069fcn7uxw.cloudfront.net","https://d20xtzwzcl0ceb.cloudfront.net","http://localhost","<anonymous>"],Je=["ddog-gov.com"];let We=Ne(),Ve=e=>{We.add((()=>Ve(e)))};function Xe(e,t){let n;const o=new j,r=new Set,s=!Je.includes(t.site)&&Me(t.telemetrySampleRate),i={[Fe]:s,[He]:s&&Me(t.telemetryConfigurationSampleRate),[Ge]:s&&Me(t.telemetryUsageSampleRate)},a={is_local_file:"file:"===window.location.protocol,is_worker:"WorkerGlobalScope"in self};return Ve=s=>{const c=E(s);if(i[s.type]&&r.size<t.maxTelemetryEventsPerPage&&!r.has(c)){const t=function(e,t,o){return D({type:"telemetry",date:Oe(),service:e,version:"6.5.1",source:"browser",_dd:{format_version:2},telemetry:D(t,{runtime_env:o,connectivity:Ue(),sdk_setup:"cdn"}),experimental_features:Array.from(Se())},void 0!==n?n():{})}(e,s,a);o.notify(t),qe("telemetry",t),r.add(c)}},u=Ye,{setContextProvider:e=>{n=e},observable:o,enabled:s}}function Ze(t,n){g(e.debug,t,n),Ve({type:Fe,message:t,status:"debug",...n})}function Ye(e,t){Ve({type:Fe,status:"error",...Ke(e),...t})}function Ke(e){if(ye(e)){const t=Y(e);return{error:{kind:t.name,stack:le(Qe(t))},message:t.message}}return{error:{stack:fe},message:`Uncaught ${E(e)}`}}function Qe(e){return e.stack=e.stack.filter((e=>!e.url||ze.some((t=>e.url.startsWith(t))))),e}function et(e,t){t.silentMultipleInit||r.error(`${e} is already initialized.`)}const tt="agent",nt="console",ot="logger",rt="network",st="source",it="report";function at(e,t,n){const o=n.getHandler(),r=Array.isArray(o)?o:[o];return ut[e]>=ut[n.getLevel()]&&r.includes(t)}const ct={ok:"ok",debug:"debug",info:"info",notice:"notice",warn:"warn",error:"error",critical:"critical",alert:"alert",emerg:"emerg"},ut={[ct.ok]:0,[ct.debug]:1,[ct.info]:2,[ct.notice]:4,[ct.warn]:5,[ct.error]:6,[ct.critical]:7,[ct.alert]:8,[ct.emerg]:9};function lt(e,{includeMessage:t=!1}={}){return{stack:e.stack,kind:e.type,message:t?e.message:void 0,causes:e.causes,fingerprint:e.fingerprint,handling:e.handling}}var dt=function(e,t,n,o){var r,s=arguments.length,i=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(s<3?r(i):s>3?r(t,n,i):r(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i};const ft="console",pt="http",gt=Object.keys(ct);class mt{constructor(e,t,n,o=pt,r=ct.debug,s={}){this.handleLogStrategy=e,this.handlerType=o,this.level=r,this.contextManager=H("logger",{customerDataTracker:t}),this.contextManager.setContext(s),n&&this.contextManager.setContextProperty("logger",{name:n})}logImplementation(e,t,n=ct.info,o,r){const s=B(t);let i;if(null!=o){i=D({error:lt(pe({stackTrace:ye(o)?Y(o):void 0,originalError:o,nonErrorPrefix:"Provided",source:ot,handling:"handled",startClocks:Ae()}),{includeMessage:!0})},s)}else i=s;this.handleLogStrategy({message:B(e),context:i,status:n},this,r)}log(e,t,n=ct.info,o){let r;at(n,pt,this)&&(r=ue("log")),this.logImplementation(e,t,n,o,r)}setContext(e){this.contextManager.setContext(e)}getContext(){return this.contextManager.getContext()}setContextProperty(e,t){this.contextManager.setContextProperty(e,t)}removeContextProperty(e){this.contextManager.removeContextProperty(e)}clearContext(){this.contextManager.clearContext()}setHandler(e){this.handlerType=e}getHandler(){return this.handlerType}setLevel(e){this.level=e}getLevel(){return this.level}}function yt(e){return function(t,n,o){let r;at(e,pt,this)&&(r=ue("log")),this.logImplementation(t,n,e,o,r)}}function ht(){const e=m().DatadogEventBridge;if(e)return{getCapabilities(){var t;return JSON.parse((null===(t=e.getCapabilities)||void 0===t?void 0:t.call(e))||"[]")},getPrivacyLevel(){var t;return null===(t=e.getPrivacyLevel)||void 0===t?void 0:t.call(e)},getAllowedWebViewHosts:()=>JSON.parse(e.getAllowedWebViewHosts()),send(t,n,o){const r=o?{id:o}:void 0;e.send(JSON.stringify({eventType:t,event:n,view:r}))}}}function bt(e){var t;void 0===e&&(e=null===(t=m().location)||void 0===t?void 0:t.hostname);const n=ht();return!!n&&n.getAllowedWebViewHosts().some((t=>e===t||e.endsWith(`.${t}`)))}function vt(e,t,n,{computeHandlingStack:o}={}){let r=e[t];if("function"!=typeof r){if(!(t in e)||!t.startsWith("on"))return{stop:_};r=_}let s=!1;const i=function(){if(s)return r.apply(this,arguments);const e=Array.from(arguments);let t;p(n,null,[{target:this,parameters:e,onPostCall:e=>{t=e},handlingStack:o?ue("instrumented method"):void 0}]);const i=r.apply(this,e);return t&&p(t,null,[i]),i};return e[t]=i,{stop:()=>{s=!0,e[t]===i&&(e[t]=r)}}}function wt(e){return St(e,location.href).href}function St(e,t){const n=function(){if(void 0===xt)try{const e=new kt("http://test/path");xt="http://test/path"===e.href}catch(e){xt=!1}return xt?kt:void 0}();if(n)try{return void 0!==t?new n(e,t):new n(e)}catch(n){throw new Error(`Failed to construct URL: ${String(n)} ${E({url:e,base:t})}`)}if(void 0===t&&!/:/.test(e))throw new Error(`Invalid URL: '${e}'`);let o=document;const r=o.createElement("a");if(void 0!==t){o=document.implementation.createHTMLDocument("");const e=o.createElement("base");e.href=t,o.head.appendChild(e),o.body.appendChild(r)}return r.href=e,r}dt([function(e,t,n){const o=n.value;n.value=function(...e){return(u?f(o):o).apply(this,e)}}],mt.prototype,"logImplementation",null),mt.prototype.ok=yt(ct.ok),mt.prototype.debug=yt(ct.debug),mt.prototype.info=yt(ct.info),mt.prototype.notice=yt(ct.notice),mt.prototype.warn=yt(ct.warn),mt.prototype.error=yt(ct.error),mt.prototype.critical=yt(ct.critical),mt.prototype.alert=yt(ct.alert),mt.prototype.emerg=yt(ct.emerg);const kt=URL;let xt,Ct;function _t(){return Ct||(Ct=new j((e=>{if(!window.fetch)return;const{stop:t}=vt(window,"fetch",(t=>function({parameters:e,onPostCall:t,handlingStack:n},o){const[r,s]=e;let i=s&&s.method;void 0===i&&r instanceof Request&&(i=r.method);const a=void 0!==i?String(i).toUpperCase():"GET",c=r instanceof Request?r.url:wt(String(r)),u=Ae(),l={state:"start",init:s,input:r,method:a,startClocks:u,url:c,handlingStack:n};o.notify(l),e[0]=l.input,e[1]=l.init,t((e=>function(e,t,n){const o=n;function r(t){o.state="resolve",Object.assign(o,t),e.notify(o)}t.then(f((e=>{r({response:e,responseType:e.type,status:e.status,isAborted:!1})})),f((e=>{var t,n;r({status:0,isAborted:(null===(n=null===(t=o.init)||void 0===t?void 0:t.signal)||void 0===n?void 0:n.aborted)||e instanceof DOMException&&e.code===DOMException.ABORT_ERR,error:e})})))}(o,e,l)))}(t,e)),{computeHandlingStack:!0});return t}))),Ct}function Et(e){return e?(parseInt(e,10)^16*Math.random()>>parseInt(e,10)/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,Et)}const Tt=/([\w-]+)\s*=\s*([^;]+)/g;function $t(e,t,n=""){const o=e.charCodeAt(t-1),r=o>=55296&&o<=56319?t+1:t;return e.length<=r?e:`${e.slice(0,r)}${n}`}let Rt,Ot,Lt;function At(){return null!=Rt?Rt:Rt=function(e=window){var t;const n=e.navigator.userAgent;if(e.chrome||/HeadlessChrome/.test(n))return 0;if(0===(null===(t=e.navigator.vendor)||void 0===t?void 0:t.indexOf("Apple"))||/safari/i.test(n)&&!/chrome|android/i.test(n))return 1;return 2}()}function It(e,t,n=0,o){const r=new Date;r.setTime(r.getTime()+n);const s=`expires=${r.toUTCString()}`,i=o&&o.crossSite?"none":"strict",a=o&&o.domain?`;domain=${o.domain}`:"",c=o&&o.secure?";secure":"",u=o&&o.partitioned?";partitioned":"";document.cookie=`${e}=${t};${s};path=/;samesite=${i}${a}${c}${u}`}function Pt(e){return function(e,t){for(Tt.lastIndex=0;;){const n=Tt.exec(e);if(!n)break;if(n[1]===t)return n[2]}}(document.cookie,e)}function Dt(e){return Ot||(Ot=function(e){const t=new Map;for(Tt.lastIndex=0;;){const n=Tt.exec(e);if(!n)break;t.set(n[1],n[2])}return t}(document.cookie)),Ot.get(e)}function Bt(e,t){It(e,"",0,t)}const qt="_dd_s";function Mt(e){return Object.values(e)}const Ut=144e5,jt=9e5,Nt=$e,Ft="cookie",Ht="local-storage",Gt=/^([a-zA-Z]+)=([a-z0-9-]+)$/;function zt(e,t){const n={isExpired:"1"};return t.trackAnonymousUser&&((null==e?void 0:e.anonymousId)?n.anonymousId=null==e?void 0:e.anonymousId:n.anonymousId=Et()),n}function Jt(e){return R(e)}function Wt(e){return!Jt(e)}function Vt(e){return void 0!==e.isExpired||!((void 0===(t=e).created||Re()-Number(t.created)<Ut)&&(void 0===t.expire||Re()<Number(t.expire)));var t}function Xt(e){e.expire=String(Re()+jt)}function Zt(e){return(t=e,Object.entries(t)).map((([e,t])=>"anonymousId"===e?`aid=${t}`:`${e}=${t}`)).join("&");var t}function Yt(e){const t={};return function(e){return!!e&&(-1!==e.indexOf("&")||Gt.test(e))}(e)&&e.split("&").forEach((e=>{const n=Gt.exec(e);if(null!==n){const[,e,o]=n;"aid"===e?t.anonymousId=o:t[e]=o}})),t}function Kt(e){const t=function(e){const t={};t.secure=!!e.useSecureSessionCookie||!!e.usePartitionedCrossSiteSessionCookie,t.crossSite=!!e.usePartitionedCrossSiteSessionCookie,t.partitioned=!!e.usePartitionedCrossSiteSessionCookie,e.trackSessionAcrossSubdomains&&(t.domain=function(){if(void 0===Lt){const e=`dd_site_test_${Et()}`,t="test",n=window.location.hostname.split(".");let o=n.pop();for(;n.length&&!Pt(e);)o=`${n.pop()}.${o}`,It(e,t,Ee,{domain:o});Bt(e,{domain:o}),Lt=o}return Lt}());return t}(e);return function(e){if(void 0===document.cookie||null===document.cookie)return!1;try{const t=`dd_cookie_test_${Et()}`,n="test";It(t,n,Te,e);const o=Pt(t)===n;return Bt(t,e),o}catch(e){return r.error(e),!1}}(t)?{type:Ft,cookieOptions:t}:void 0}function Qt(e,t){const n={isLockEnabled:0===At(),persistSession:(o=t,e=>{It(qt,Zt(e),jt,o)}),retrieveSession:en,expireSession:n=>function(e,t,n){const o=zt(t,n);It(qt,Zt(o),n.trackAnonymousUser?Nt:Ut,e)}(t,n,e)};var o;return function(e){if(!Dt(qt)){const t=Dt("_dd"),n=Dt("_dd_r"),o=Dt("_dd_l"),r={};t&&(r.id=t),o&&/^[01]$/.test(o)&&(r.logs=o),n&&/^[012]$/.test(n)&&(r.rum=n),Wt(r)&&(Xt(r),e.persistSession(r))}}(n),n}function en(){return Yt(Pt(qt))}function tn(){try{const e=Et(),t=`_dd_test_${e}`;localStorage.setItem(t,e);const n=localStorage.getItem(t);return localStorage.removeItem(t),e===n?{type:Ht}:void 0}catch(e){return}}function nn(e){return{isLockEnabled:!1,persistSession:on,retrieveSession:rn,expireSession:t=>function(e,t){on(zt(e,t))}(t,e)}}function on(e){localStorage.setItem(qt,Zt(e))}function rn(){return Yt(localStorage.getItem(qt))}const sn=[];let an;function cn(e,t,n=0){var o;const{isLockEnabled:r,persistSession:s,expireSession:i}=t,a=e=>s({...e,lock:u}),c=()=>{const e=t.retrieveSession(),n=e.lock;return e.lock&&delete e.lock,{session:e,lock:n}};if(an||(an=e),e!==an)return void sn.push(e);if(r&&n>=100)return void ln(t);let u,l=c();if(r){if(l.lock)return void un(e,t,n);if(u=Et(),a(l.session),l=c(),l.lock!==u)return void un(e,t,n)}let d=e.process(l.session);if(r&&(l=c(),l.lock!==u))un(e,t,n);else{if(d&&(Vt(d)?i(d):(Xt(d),r?a(d):s(d))),r&&(!d||!Vt(d))){if(l=c(),l.lock!==u)return void un(e,t,n);s(l.session),d=l.session}null===(o=e.after)||void 0===o||o.call(e,d||l.session),ln(t)}}function un(e,t,n){w((()=>{cn(e,t,n+1)}),10)}function ln(e){an=void 0;const t=sn.shift();t&&cn(t,e)}const dn=Ee;function fn(e){switch(e.sessionPersistence){case Ft:return Kt(e);case Ht:return tn();case void 0:{let t=Kt(e);return!t&&e.allowFallbackToLocalStorage&&(t=tn()),t}default:r.error(`Invalid session persistence '${String(e.sessionPersistence)}'`)}}function pn(e,t,n,o){const r=new j,s=new j,i=new j,a=e.type===Ft?Qt(t,e.cookieOptions):nn(t),{expireSession:c}=a,u=k((function(){cn({process:e=>Vt(e)?zt(e,t):void 0,after:p},a)}),dn);let l;g();const{throttled:d,cancel:f}=C((()=>{cn({process:e=>{if(Jt(e))return;const t=p(e);return function(e){if(Jt(e))return!1;const{trackingType:t,isTracked:r}=o(e[n]);e[n]=t,delete e.isExpired,r&&!e.id&&(e.id=Et(),e.created=String(Re()))}(t),t},after:e=>{Wt(e)&&!m()&&function(e){l=e,r.notify()}(e),l=e}},a)}),dn);function p(e){return Vt(e)&&(e=zt(e,t)),m()&&(!function(e){return l.id!==e.id||l[n]!==e[n]}(e)?(i.notify({previousState:l,newState:e}),l=e):(l=zt(l,t),s.notify())),e}function g(){cn({process:e=>{if(Jt(e))return zt(e,t)},after:e=>{l=e}},a)}function m(){return void 0!==l[n]}return{expandOrRenewSession:d,expandSession:function(){cn({process:e=>m()?p(e):void 0},a)},getSession:()=>l,renewObservable:r,expireObservable:s,sessionStateUpdateObservable:i,restartSession:g,expire:()=>{f(),c(l),p(zt(l,t))},stop:()=>{x(u)},updateSessionState:function(e){cn({process:t=>({...t,...e}),after:p},a)}}}function gn(e,t,n){const o=function(e,t){const n=`/api/v2/${t}`,o=e.proxy;if("string"==typeof o){const e=wt(o);return t=>`${e}?ddforward=${encodeURIComponent(`${n}?${t}`)}`}if("function"==typeof o)return e=>o({path:n,parameters:e});const r=function(e,t){const{site:n=xe,internalAnalyticsSubdomain:o}=t;if("logs"===e&&t.usePciIntake&&n===xe)return Ce;if(o&&n===xe)return`${o}.${xe}`;if(n===ke)return`http-intake.logs.${n}`;const r=n.split("."),s=r.pop();return`browser-intake-${r.join("-")}.${s}`}(t,e);return e=>`https://${r}${n}?${e}`}(e,t);return{build(r,s){const i=function({clientToken:e,internalAnalyticsSubdomain:t},n,o,r,{retry:s,encoding:i}){const a=["sdk_version:6.5.1",`api:${r}`].concat(o);s&&a.push(`retry_count:${s.count}`,`retry_after:${s.lastFailureStatus}`);const c=["ddsource=browser",`ddtags=${encodeURIComponent(a.join(","))}`,`dd-api-key=${e}`,`dd-evp-origin-version=${encodeURIComponent("6.5.1")}`,"dd-evp-origin=browser",`dd-request-id=${Et()}`];i&&c.push(`dd-evp-encoding=${i}`);"rum"===n&&c.push(`batch_time=${Oe()}`);t&&c.reverse();return c.join("&")}(e,t,n,r,s);return o(i)},urlPrefix:o(""),trackType:t}}function mn(e,t){const n=200-e.length-1;(t.length>n||function(e){if(!function(){try{return new RegExp("[\\p{Ll}]","u"),!0}catch(e){return!1}}())return!1;return new RegExp("[^\\p{Ll}\\p{Lo}0-9_:./-]","u").test(e)}(t))&&r.warn(`${e} value doesn't meet tag requirements and will be sanitized. ${a} ${s}/getting_started/tagging/#defining-tags`);return`${e}:${t.replace(/,/g,"_")}`}function yn(e){const t=e.site||xe,n=function(e){const{env:t,service:n,version:o,datacenter:r}=e,s=[];return t&&s.push(mn("env",t)),n&&s.push(mn("service",n)),o&&s.push(mn("version",o)),r&&s.push(mn("datacenter",r)),s}(e),o=function(e,t){return{logsEndpointBuilder:gn(e,"logs",t),rumEndpointBuilder:gn(e,"rum",t),sessionReplayEndpointBuilder:gn(e,"replay",t)}}(e,n),r=function(e,t){if(!e.replica)return;const n={...e,site:xe,clientToken:e.replica.clientToken},o={logsEndpointBuilder:gn(n,"logs",t),rumEndpointBuilder:gn(n,"rum",t)};return{applicationId:e.replica.applicationId,...o}}(e,n);return{replica:r,site:t,...o}}function hn(e,t){return null==e||"string"==typeof e||(r.error(`${t} must be defined as a string`),!1)}function bn(e,t){return!!(void 0===e||(n=e,function(e){return"number"==typeof e}(n)&&n>=0&&n<=100))||(r.error(`${t} Sample Rate should be a number between 0 and 100`),!1);var n}function vn(e){var t,n,o,i,u,l;if(e&&e.clientToken){if((!(d=e.site)||"string"!=typeof d||/(datadog|ddog|datad0g|dd0g)/.test(d)||(r.error(`Site should be a valid Datadog site. ${a} ${s}/getting_started/site/.`),0))&&bn(e.sessionSampleRate,"Session")&&bn(e.telemetrySampleRate,"Telemetry")&&bn(e.telemetryConfigurationSampleRate,"Telemetry Configuration")&&bn(e.telemetryUsageSampleRate,"Telemetry Usage")&&hn(e.version,"Version")&&hn(e.env,"Env")&&hn(e.service,"Service")){var d;if(void 0===e.trackingConsent||$(G,e.trackingConsent))return{beforeSend:e.beforeSend&&c(e.beforeSend,"beforeSend threw an error:"),sessionStoreStrategyType:fn(e),sessionSampleRate:null!==(t=e.sessionSampleRate)&&void 0!==t?t:100,telemetrySampleRate:null!==(n=e.telemetrySampleRate)&&void 0!==n?n:20,telemetryConfigurationSampleRate:null!==(o=e.telemetryConfigurationSampleRate)&&void 0!==o?o:5,telemetryUsageSampleRate:null!==(i=e.telemetryUsageSampleRate)&&void 0!==i?i:5,service:e.service||void 0,silentMultipleInit:!!e.silentMultipleInit,allowUntrustedEvents:!!e.allowUntrustedEvents,trackingConsent:null!==(u=e.trackingConsent)&&void 0!==u?u:G.GRANTED,trackAnonymousUser:null===(l=e.trackAnonymousUser)||void 0===l||l,storeContextsAcrossPages:!!e.storeContextsAcrossPages,batchBytesLimit:16384,eventRateLimiterThreshold:3e3,maxTelemetryEventsPerPage:15,flushTimeout:3e4,batchMessagesLimit:50,messageBytesLimit:262144,...yn(e)};r.error('Tracking Consent should be either "granted" or "not-granted"')}}else r.error("Client Token is not configured, we will not send any data.")}const wn={intervention:"intervention",deprecation:"deprecation",cspViolation:"csp_violation"};function Sn(e,t){const n=[];t.includes(wn.cspViolation)&&n.push(function(e){return new j((t=>{const{stop:n}=z(e,document,"securitypolicyviolation",(e=>{t.notify(function(e){const t=`'${e.blockedURI}' blocked by '${e.effectiveDirective}' directive`;return kn({type:e.effectiveDirective,message:`${wn.cspViolation}: ${t}`,originalError:e,csp:{disposition:e.disposition},stack:xn(e.effectiveDirective,e.originalPolicy?`${t} of the policy "${$t(e.originalPolicy,100,"...")}"`:"no policy",e.sourceFile,e.lineNumber,e.columnNumber)})}(e))}));return n}))}(e));const o=t.filter((e=>e!==wn.cspViolation));return o.length&&n.push(function(e){return new j((t=>{if(!window.ReportingObserver)return;const n=f(((e,n)=>e.forEach((e=>t.notify(function(e){const{type:t,body:n}=e;return kn({type:n.id,message:`${t}: ${n.message}`,originalError:e,stack:xn(n.id,n.message,n.sourceFile,n.lineNumber,n.columnNumber)})}(e)))))),o=new window.ReportingObserver(n,{types:e,buffered:!0});return o.observe(),()=>{o.disconnect()}}))}(o)),N(...n)}function kn(e){return{startClocks:Ae(),source:it,handling:"unhandled",...e}}function xn(e,t,n,o,r){return n?le({name:e,message:t,stack:[{func:"?",url:n,line:null!=o?o:void 0,column:null!=r?r:void 0}]}):void 0}function Cn(e,t,n){return void 0===e?[]:"all"===e||Array.isArray(e)&&e.every((e=>t.includes(e)))?"all"===e?t:function(e){const t=new Set;return e.forEach((e=>t.add(e))),Array.from(t)}(e):void r.error(`${n} should be "all" or an array with allowed values "${t.join('", "')}"`)}function _n(t,n,o){const s=Ne();let i,a;const c=n.observable.subscribe(u);function u(){if(!a||!i||!n.isGranted())return;c.unsubscribe();const e=o(i,a);s.drain(e)}return{init(t){if(!t)return void r.error("Missing configuration");if(we(t.enableExperimentalFeatures),bt()&&(t=function(e){return{...e,clientToken:"empty"}}(t)),i=t,a)return void et("DD_LOGS",t);const o=function(t){!0===t.usePciIntake&&t.site&&"datadoghq.com"!==t.site&&r.warn("PCI compliance for Logs is only available for Datadog organizations in the US1 site. Default intake will be used.");const n=vn(t),o=Cn(t.forwardConsoleLogs,Mt(e),"Forward Console Logs"),s=Cn(t.forwardReports,Mt(wn),"Forward Reports");if(n&&o&&s)return t.forwardErrorsToLogs&&!o.includes(e.error)&&o.push(e.error),{forwardErrorsToLogs:!1!==t.forwardErrorsToLogs,forwardConsoleLogs:o,forwardReports:s,requestErrorResponseLengthLimit:32768,...n}}(t);o&&(a=o,_t().subscribe(_),n.tryToInit(o.trackingConsent),u())},get initConfiguration(){return i},getInternalContext:_,handleLog(e,n,o,r=t(),i=Oe()){s.add((t=>t.handleLog(e,n,o,r,i)))}}}const En="logs";const Tn={HIDDEN:"visibility_hidden",UNLOADING:"before_unload",PAGEHIDE:"page_hide",FROZEN:"page_frozen"};function $n(){return Boolean(window._DATADOG_SYNTHETICS_INJECTS_RUM||Dt("datadog-synthetics-injects-rum"))}function Rn(){const e=window._DATADOG_SYNTHETICS_PUBLIC_ID||Dt("datadog-synthetics-public-id");return"string"==typeof e?e:void 0}function On(){const e=window._DATADOG_SYNTHETICS_RESULT_ID||Dt("datadog-synthetics-result-id");return"string"==typeof e?e:void 0}const Ln=1/0;let An=null;const In=new Set;function Pn({expireDelay:e,maxEntries:t}){let n=[];const o=[];An||(An=k((()=>{In.forEach((e=>e()))}),6e4));const r=()=>{const t=Le()-e;for(;n.length>0&&n[n.length-1].endTime<t;){const e=n.pop();e&&o.push(e.startTime)}};return In.add(r),{add:function(e,o){const r={value:e,startTime:o,endTime:Ln,remove:()=>{je(n,r)},close:e=>{r.endTime=e}};return t&&n.length>=t&&n.pop(),n.unshift(r),r},find:function(e=Infinity,t={returnInactive:!1}){for(const o of n)if(o.startTime<=e){if(t.returnInactive||e<=o.endTime)return o.value;break}},closeActive:function(e){const t=n[0];t&&t.endTime===Ln&&t.close(e)},findAll:function(e=Infinity,t=0){const o=Ie(e,t);return n.filter((t=>t.startTime<=o&&e<=t.endTime)).map((e=>e.value))},reset:function(){n=[]},stop:function(){In.delete(r),0===In.size&&An&&(x(An),An=null)},getAllEntries:function(){return n.map((({startTime:e,endTime:t,value:n})=>({startTime:e,endTime:t===Ln?"Infinity":t,value:n})))},getDeletedEntries:function(){return o}}}const Dn=Te,Bn=Ut;let qn=[];function Mn(e,t,n,o){const r=new j,s=new j,i=pn(e.sessionStoreStrategyType,e,t,n);qn.push((()=>i.stop()));const a=Pn({expireDelay:Bn});function c(){return{id:i.getSession().id,trackingType:i.getSession()[t],isReplayForced:!!i.getSession().forcedReplay,anonymousId:i.getSession().anonymousId}}return qn.push((()=>a.stop())),i.renewObservable.subscribe((()=>{a.add(c(),Le()),r.notify()})),i.expireObservable.subscribe((()=>{s.notify(),a.closeActive(Le())})),i.expandOrRenewSession(),a.add(c(),[0,Be()][0]),o.observable.subscribe((()=>{o.isGranted()?i.expandOrRenewSession():i.expire()})),function(e,t){const{stop:n}=J(e,window,["click","touchstart","keydown","scroll"],t,{capture:!0,passive:!0});qn.push(n)}(e,(()=>{o.isGranted()&&i.expandOrRenewSession()})),function(e,t){const n=()=>{"visible"===document.visibilityState&&t()},{stop:o}=z(e,document,"visibilitychange",n);qn.push(o);const r=k(n,Dn);qn.push((()=>{x(r)}))}(e,(()=>i.expandSession())),function(e,t){const{stop:n}=z(e,window,"resume",t,{capture:!0});qn.push(n)}(e,(()=>i.restartSession())),{findSession:(e,t)=>a.find(e,t),renewObservable:r,expireObservable:s,sessionStateUpdateObservable:i.sessionStateUpdateObservable,expire:i.expire,updateSessionState:i.updateSessionState}}function Un(e,t){const n=Mn(e,"logs",(t=>function(e,t){const n=function(e){return"0"===e||"1"===e}(t)?t:jn(e);return{trackingType:n,isTracked:"1"===n}}(e,t)),t);return{findTrackedSession:(e,t={returnInactive:!1})=>{const o=n.findSession(e,t);return o&&"1"===o.trackingType?{id:o.id,anonymousId:o.anonymousId}:void 0},expireObservable:n.expireObservable}}function jn(e){return Me(e.sessionSampleRate)?"1":"0"}let Nn=!1;function Fn(e){const t=window;if($n()){const e=n(t.DD_RUM_SYNTHETICS);return e||Nn||(Nn=!0,Ze("Logs sent before RUM is injected by the synthetics worker",{testId:Rn(),resultId:On()})),e}return n(t.DD_RUM);function n(t){if(t&&t.getInternalContext)return t.getInternalContext(e)}}function Hn(e,t,n,o,r){const s=gt.concat(["custom"]),i={};s.forEach((e=>{i[e]=function(e,t,n){let o=0,r=!1;return{isLimitReached(){if(0===o&&w((()=>{o=0}),Te),o+=1,o<=t||r)return r=!1,!1;if(o===t+1){r=!0;try{n({message:`Reached max number of ${e}s by minute: ${t}`,source:tt,startClocks:Ae()})}finally{r=!1}}return!0}}}(e,t.eventRateLimiterThreshold,r)})),n.subscribe(0,(({rawLogsEvent:r,messageContext:s,savedCommonContext:a,domainContext:c})=>{var u,l;const d=Pe(r.date),f=e.findTrackedSession(d);if(!e.findTrackedSession(d,{returnInactive:!0}))return;const p=a||o();let g;!R(p.account)&&p.account.id&&(g=p.account),f&&f.anonymousId&&!p.user.anonymous_id&&(p.user.anonymous_id=f.anonymousId);const m=D({service:t.service,session_id:f?f.id:void 0,session:f?{id:f.id}:void 0,usr:R(p.user)?void 0:p.user,account:g,view:p.view},p.context,Fn(d),r,s);!1===(null===(u=t.beforeSend)||void 0===u?void 0:u.call(t,m,c))||m.origin!==tt&&(null!==(l=i[m.status])&&void 0!==l?l:i.custom).isLimitReached()||n.notify(1,m)}))}let Gn={};function zn(n){return N(...n.map((n=>(Gn[n]||(Gn[n]=function(n){return new j((o=>{const r=t[n];return t[n]=(...t)=>{r.apply(console,t);const s=ue("console error");p((()=>{o.notify(function(t,n,o){const r=t.map((e=>function(e){if("string"==typeof e)return B(e);if(ye(e))return de(Y(e));return E(B(e),void 0,2)}(e))).join(" ");let s;if(n===e.error){const e=t.find(ye);s={stack:e?le(Y(e)):void 0,fingerprint:ge(e),causes:e?he(e,"console"):void 0,startClocks:Ae(),message:r,source:nt,handling:"handled",handlingStack:o,context:me(e)}}return{api:n,message:r,error:s,handlingStack:o}}(t,n,s))}))},()=>{t[n]=r}}))}(n)),Gn[n]))))}const Jn={[e.log]:ct.info,[e.debug]:ct.debug,[e.info]:ct.info,[e.warn]:ct.warn,[e.error]:ct.error};let Wn;const Vn=new WeakMap;function Xn(e){return Wn||(Wn=function(e){return new j((t=>{const{stop:n}=vt(XMLHttpRequest.prototype,"open",Zn),{stop:o}=vt(XMLHttpRequest.prototype,"send",(n=>{!function({target:e,handlingStack:t},n,o){const r=Vn.get(e);if(!r)return;const s=r;s.state="start",s.startClocks=Ae(),s.isAborted=!1,s.xhr=e,s.handlingStack=t;let i=!1;const{stop:a}=vt(e,"onreadystatechange",(()=>{e.readyState===XMLHttpRequest.DONE&&c()})),c=()=>{if(u(),a(),i)return;i=!0;const t=r;var n,c;t.state="complete",t.duration=(n=s.startClocks.timeStamp,Oe()-n),t.status=e.status,o.notify((c=t,{...c}))},{stop:u}=z(n,e,"loadend",c);o.notify(s)}(n,e,t)}),{computeHandlingStack:!0}),{stop:r}=vt(XMLHttpRequest.prototype,"abort",Yn);return()=>{n(),o(),r()}}))}(e)),Wn}function Zn({target:e,parameters:[t,n]}){Vn.set(e,{state:"open",method:String(t).toUpperCase(),url:wt(String(n))})}function Yn({target:e}){const t=Vn.get(e);t&&(t.isAborted=!0)}function Kn(e){return e>=500}function Qn(e,t){if(!e.forwardErrorsToLogs)return{stop:_};const n=Xn(e).subscribe((e=>{"complete"===e.state&&r("xhr",e)})),o=_t().subscribe((e=>{"resolve"===e.state&&r("fetch",e)}));function r(n,o){var r;function s(e){const r={isAborted:o.isAborted,handlingStack:o.handlingStack};t.notify(0,{rawLogsEvent:{message:`${to(n)} error ${o.method} ${o.url}`,date:o.startClocks.timeStamp,error:{stack:e||"Failed to load",handling:void 0},http:{method:o.method,status_code:o.status,url:o.url},status:ct.error,origin:rt},domainContext:r})}r=o.url,_e.every((e=>r.includes(e)))||!function(e){return 0===e.status&&"opaque"!==e.responseType}(o)&&!Kn(o.status)||("xhr"in o?function(e,t,n){"string"==typeof e.response?n(eo(e.response,t)):n(e.response)}(o.xhr,e,s):o.response?function(e,t,n){const o=function(e){try{return e.clone()}catch(e){return}}(e);o&&o.body?window.TextDecoder?function(e,t,n){!function(e,t,n){const o=e.getReader(),r=[];let s=0;function i(){let e,i;if(o.cancel().catch(_),n.collectStreamBody){let t;if(1===r.length)t=r[0];else{t=new Uint8Array(s);let e=0;r.forEach((n=>{t.set(n,e),e+=n.length}))}e=t.slice(0,n.bytesLimit),i=t.length>n.bytesLimit}t(void 0,e,i)}!function e(){o.read().then(f((t=>{t.done?i():(n.collectStreamBody&&r.push(t.value),s+=t.value.length,s>n.bytesLimit?i():e())})),f((e=>t(e))))}()}(e,((e,t,o)=>{if(e)n(e);else{let e=(new TextDecoder).decode(t);o&&(e+="..."),n(void 0,e)}}),{bytesLimit:t,collectStreamBody:!0})}(o.body,t.requestErrorResponseLengthLimit,((e,t)=>{n(e?`Unable to retrieve response: ${e}`:t)})):o.text().then(f((e=>n(eo(e,t)))),f((e=>n(`Unable to retrieve response: ${e}`)))):n()}(o.response,e,s):o.error&&function(e,t,n){n(eo(le(Y(e)),t))}(o.error,e,s))}return{stop:()=>{n.unsubscribe(),o.unsubscribe()}}}function eo(e,t){return e.length>t.requestErrorResponseLengthLimit?`${e.substring(0,t.requestErrorResponseLengthLimit)}...`:e}function to(e){return"xhr"===e?"XHR":"Fetch"}function no(e){const t=(t,n)=>{const o=pe({stackTrace:t,originalError:n,startClocks:Ae(),nonErrorPrefix:"Uncaught",source:st,handling:"unhandled"});e.notify(o)},{stop:n}=(o=t,vt(window,"onerror",(({parameters:[e,t,n,r,s]})=>{let i;i=ye(s)?Y(s):ae(e,t,n,r),o(i,null!=s?s:e)})));var o;const{stop:r}=function(e){return vt(window,"onunhandledrejection",(({parameters:[t]})=>{const n=t.reason||"Empty reason",o=Y(n);e(o,n)}))}(t);return{stop:()=>{n(),r()}}}const oo=class{constructor(){this.callbacks={}}notify(e,t){const n=this.callbacks[e];n&&n.forEach((e=>e(t)))}subscribe(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),{unsubscribe:()=>{this.callbacks[e]=this.callbacks[e].filter((e=>t!==e))}}}};function ro(e){return{handleLog:function(o,r,s,i,a){const c=D(r.getContext(),o.context);if(at(o.status,ft,r)&&function({status:e,message:o},r){n[so[e]].call(t,o,r)}(o,c),at(o.status,pt,r)){const t={rawLogsEvent:{date:a||Oe(),message:o.message,status:o.status,origin:ot},messageContext:c,savedCommonContext:i};s&&(t.domainContext={handlingStack:s}),e.notify(0,t)}}}}const so={[ct.ok]:e.debug,[ct.debug]:e.debug,[ct.info]:e.info,[ct.notice]:e.info,[ct.warn]:e.warn,[ct.error]:e.error,[ct.critical]:e.error,[ct.alert]:e.error,[ct.emerg]:e.error};function io({encoder:e,request:t,flushController:n,messageBytesLimit:o}){let s={};const c=n.flushObservable.subscribe((n=>function(n){const o=Mt(s).join("\n");s={};const r=(a=n.reason,Mt(Tn).includes(a)),i=r?t.sendOnExit:t.send;var a;if(r&&e.isAsync){const t=e.finishSync();t.outputBytesCount&&i(ao(t));const n=[t.pendingData,o].filter(Boolean).join("\n");n&&i({data:n,bytesCount:b(n)})}else o&&e.write(e.isEmpty?o:`\n${o}`),e.finish((e=>{i(ao(e))}))}(n)));function u(t,c){const u=E(t),l=e.estimateEncodedBytesCount(u);l>=o?r.warn(`Discarded a message whose size was bigger than the maximum allowed size ${o}KB. ${a} ${i}/#technical-limitations`):(function(e){return void 0!==e&&void 0!==s[e]}(c)&&function(t){const o=s[t];delete s[t];const r=e.estimateEncodedBytesCount(o);n.notifyAfterRemoveMessage(r)}(c),function(t,o,r){n.notifyBeforeAddMessage(o),void 0!==r?(s[r]=t,n.notifyAfterAddMessage()):e.write(e.isEmpty?t:`\n${t}`,(e=>{n.notifyAfterAddMessage(e-o)}))}(u,l,c))}return{flushController:n,add:u,upsert:u,stop:c.unsubscribe}}function ao(e){let t;return t="string"==typeof e.output?e.output:new Blob([e.output],{type:"text/plain"}),{data:t,bytesCount:e.outputBytesCount,encoding:e.encoding}}const co=3145728,uo=Ee;function lo(e,t,n,o,r){0===t.transportStatus&&0===t.queuedPayloads.size()&&t.bandwidthMonitor.canHandle(e)?po(e,t,n,{onSuccess:()=>go(0,t,n,o,r),onFailure:()=>{t.queuedPayloads.enqueue(e),fo(t,n,o,r)}}):t.queuedPayloads.enqueue(e)}function fo(e,t,n,o){2===e.transportStatus&&w((()=>{po(e.queuedPayloads.first(),e,t,{onSuccess:()=>{e.queuedPayloads.dequeue(),e.currentBackoffTime=uo,go(1,e,t,n,o)},onFailure:()=>{e.currentBackoffTime=Math.min(6e4,2*e.currentBackoffTime),fo(e,t,n,o)}})}),e.currentBackoffTime)}function po(e,t,n,{onSuccess:o,onFailure:r}){t.bandwidthMonitor.add(e),n(e,(n=>{t.bandwidthMonitor.remove(e),!function(e){return"opaque"!==e.type&&(0===e.status&&!navigator.onLine||408===e.status||429===e.status||Kn(e.status))}(n)?(t.transportStatus=0,o()):(t.transportStatus=t.bandwidthMonitor.ongoingRequestCount>0?1:2,e.retry={count:e.retry?e.retry.count+1:1,lastFailureStatus:n.status},r())}))}function go(e,t,n,o,r){0===e&&t.queuedPayloads.isFull()&&!t.queueFullReported&&(r({message:`Reached max ${o} events size queued for upload: 3MiB`,source:tt,startClocks:Ae()}),t.queueFullReported=!0);const s=t.queuedPayloads;for(t.queuedPayloads=mo();s.size()>0;)lo(s.dequeue(),t,n,o,r)}function mo(){const e=[];return{bytesCount:0,enqueue(t){this.isFull()||(e.push(t),this.bytesCount+=t.bytesCount)},first:()=>e[0],dequeue(){const t=e.shift();return t&&(this.bytesCount-=t.bytesCount),t},size:()=>e.length,isFull(){return this.bytesCount>=co}}}function yo(e,t,n){const o={transportStatus:0,currentBackoffTime:uo,bandwidthMonitor:{ongoingRequestCount:0,ongoingByteCount:0,canHandle(e){return 0===this.ongoingRequestCount||this.ongoingByteCount+e.bytesCount<=81920&&this.ongoingRequestCount<32},add(e){this.ongoingRequestCount+=1,this.ongoingByteCount+=e.bytesCount},remove(e){this.ongoingRequestCount-=1,this.ongoingByteCount-=e.bytesCount}},queuedPayloads:mo(),queueFullReported:!1},r=(n,o)=>function(e,t,n,o){const r=function(){try{return window.Request&&"keepalive"in new Request("http://a")}catch(e){return!1}}()&&n.bytesCount<t;if(r){const t=e.build("fetch",n);fetch(t,{method:"POST",body:n.data,keepalive:!0,mode:"cors"}).then(f((e=>null==o?void 0:o({status:e.status,type:e.type}))),f((()=>{bo(e.build("xhr",n),n.data,o)})))}else{bo(e.build("xhr",n),n.data,o)}}(e,t,n,o);return{send:t=>{lo(t,o,r,e.trackType,n)},sendOnExit:n=>{!function(e,t,n){const o=!!navigator.sendBeacon&&n.bytesCount<t;if(o)try{const t=e.build("beacon",n);if(navigator.sendBeacon(t,n.data))return}catch(e){!function(e){ho||(ho=!0,Ye(e))}(e)}const r=e.build("xhr",n);bo(r,n.data)}(e,t,n)}}}let ho=!1;function bo(e,t,n){const o=new XMLHttpRequest;o.open("POST",e,!0),t instanceof Blob&&o.setRequestHeader("Content-Type",t.type),z({allowUntrustedEvents:!0},o,"loadend",(()=>{null==n||n({status:o.status})}),{once:!0}),o.send(t)}function vo({messagesLimit:e,bytesLimit:t,durationLimit:n,pageExitObservable:o,sessionExpireObservable:r}){const s=o.subscribe((e=>d(e.reason))),i=r.subscribe((()=>d("session_expire"))),a=new j((()=>()=>{s.unsubscribe(),i.unsubscribe()}));let c,u=0,l=0;function d(e){if(0===l)return;const t=l,n=u;l=0,u=0,f(),a.notify({reason:e,messagesCount:t,bytesCount:n})}function f(){S(c),c=void 0}return{flushObservable:a,get messagesCount(){return l},notifyBeforeAddMessage(e){u+e>=t&&d("bytes_limit"),l+=1,u+=e,void 0===c&&(c=w((()=>{d("duration_limit")}),n))},notifyAfterAddMessage(n=0){u+=n,l>=e?d("messages_limit"):u>=t&&d("bytes_limit")},notifyAfterRemoveMessage(e){u-=e,l-=1,0===l&&f()}}}function wo(e,t,n,o,r,s,i=io){const a=u(e,t),c=n&&u(e,n);function u(e,{endpoint:t,encoder:n}){return i({encoder:n,request:yo(t,e.batchBytesLimit,o),flushController:vo({messagesLimit:e.batchMessagesLimit,bytesLimit:e.batchBytesLimit,durationLimit:e.flushTimeout,pageExitObservable:r,sessionExpireObservable:s}),messageBytesLimit:e.messageBytesLimit})}return{flushObservable:a.flushController.flushObservable,add(e,t=!0){a.add(e),c&&t&&c.add(n.transformMessage?n.transformMessage(e):e)},upsert:(e,t)=>{a.upsert(e,t),c&&c.upsert(n.transformMessage?n.transformMessage(e):e,t)},stop:()=>{a.stop(),c&&c.stop()}}}function So(){let e="",t=0;return{isAsync:!1,get isEmpty(){return!e},write(n,o){const r=b(n);t+=r,e+=n,o&&o(r)},finish(e){e(this.finishSync())},finishSync(){const n={output:e,outputBytesCount:t,rawBytesCount:t,pendingData:""};return e="",t=0,n},estimateEncodedBytesCount:e=>e.length}}function ko(e,t,n,o,r){const s=Xe("browser-logs-sdk",t);s.setContextProvider((()=>{var e,t,n,o,s,i;return{application:{id:null===(e=Fn())||void 0===e?void 0:e.application_id},session:{id:null===(t=r.findTrackedSession())||void 0===t?void 0:t.id},view:{id:null===(o=null===(n=Fn())||void 0===n?void 0:n.view)||void 0===o?void 0:o.id},action:{id:null===(i=null===(s=Fn())||void 0===s?void 0:s.user_action)||void 0===i?void 0:i.id}}}));const i=[];if(bt()){const e=ht(),t=s.observable.subscribe((t=>e.send("internal_telemetry",t)));i.push((()=>t.unsubscribe()))}else{const e=wo(t,{endpoint:t.rumEndpointBuilder,encoder:So()},t.replica&&{endpoint:t.replica.rumEndpointBuilder,encoder:So()},n,o,r.expireObservable);i.push((()=>e.stop()));const a=s.observable.subscribe((n=>e.add(n,function(e){return"datad0g.com"===e.site}(t))));i.push((()=>a.unsubscribe()))}return We.drain(),function(e){Ve({type:He,configuration:e})}(function(e){const t={session_sample_rate:(n=e).sessionSampleRate,telemetry_sample_rate:n.telemetrySampleRate,telemetry_configuration_sample_rate:n.telemetryConfigurationSampleRate,telemetry_usage_sample_rate:n.telemetryUsageSampleRate,use_before_send:!!n.beforeSend,use_partitioned_cross_site_session_cookie:n.usePartitionedCrossSiteSessionCookie,use_secure_session_cookie:n.useSecureSessionCookie,use_proxy:!!n.proxy,silent_multiple_init:n.silentMultipleInit,track_session_across_subdomains:n.trackSessionAcrossSubdomains,track_anonymous_user:n.trackAnonymousUser,session_persistence:n.sessionPersistence,allow_fallback_to_local_storage:!!n.allowFallbackToLocalStorage,store_contexts_across_pages:!!n.storeContextsAcrossPages,allow_untrusted_events:!!n.allowUntrustedEvents,tracking_consent:n.trackingConsent};var n;return{forward_errors_to_logs:e.forwardErrorsToLogs,forward_console_logs:e.forwardConsoleLogs,forward_reports:e.forwardReports,use_pci_intake:e.usePciIntake,...t}}(e)),{telemetry:s,stop:()=>{i.forEach((e=>e()))}}}const xo=function(e){const t=O(),n=H("global context",{customerDataTracker:t.getOrCreateTracker(2)}),o=H("user",{customerDataTracker:t.getOrCreateTracker(1),propertiesConfig:{id:{type:"string"},name:{type:"string"},email:{type:"string"}}}),r=H("account",{customerDataTracker:t.getOrCreateTracker(1),propertiesConfig:{id:{type:"string",required:!0},name:{type:"string"}}}),s=function(e){const t=new j;return{tryToInit(t){e||(e=t)},update(n){e=n,t.notify()},isGranted:()=>e===G.GRANTED,observable:t}}();function i(){return function(e,t,n){return{view:{referrer:document.referrer,url:window.location.href},context:e.getContext(),user:t.getContext(),account:n.getContext()}}(n,o,r)}let a=_n(i,s,((t,c)=>{t.storeContextsAcrossPages&&(X(c,n,En,2),X(c,o,En,1),X(c,r,En,4));const u=e(t,c,i,s);return a=function(e,t){return{init:e=>{et("DD_LOGS",e)},initConfiguration:e,...t}}(t,u),u}));const c={};return function(e){const t={version:"6.5.1",onReady(e){e()},...e};return Object.defineProperty(t,"_setDebug",{get:()=>d,enumerable:!1}),t}({logger:new mt(((...e)=>a.handleLog(...e)),t.createDetachedTracker()),init:f((e=>a.init(e))),setTrackingConsent:f((e=>{s.update(e),Ve({type:Ge,usage:{feature:"set-tracking-consent",tracking_consent:e}})})),getGlobalContext:f((()=>n.getContext())),setGlobalContext:f((e=>n.setContext(e))),setGlobalContextProperty:f(((e,t)=>n.setContextProperty(e,t))),removeGlobalContextProperty:f((e=>n.removeContextProperty(e))),clearGlobalContext:f((()=>n.clearContext())),createLogger:f(((e,n={})=>(c[e]=new mt(((...e)=>a.handleLog(...e)),t.createDetachedTracker(),B(e),n.handler,n.level,B(n.context)),c[e]))),getLogger:f((e=>c[e])),getInitConfiguration:f((()=>P(a.initConfiguration))),getInternalContext:f((e=>a.getInternalContext(e))),setUser:f(o.setContext),getUser:f(o.getContext),setUserProperty:f(o.setContextProperty),removeUserProperty:f(o.removeContextProperty),clearUser:f(o.clearContext),setAccount:f(r.setContext),getAccount:f(r.getContext),setAccountProperty:f(r.setContextProperty),removeAccountProperty:f(r.removeContextProperty),clearAccount:f(r.clearContext)})}((function(e,t,n,o){const r=new oo,s=[];r.subscribe(1,(e=>qe("logs",e)));const i=function(e){return t=>{e.notify(0,{rawLogsEvent:{message:t.message,date:t.startClocks.timeStamp,origin:tt,status:ct.error}}),Ze("Error reported to customer",{"error.message":t.message})}}(r),a=function(e){return new j((t=>{const{stop:n}=J(e,window,["visibilitychange","freeze"],(e=>{"visibilitychange"===e.type&&"hidden"===document.visibilityState?t.notify({reason:Tn.HIDDEN}):"freeze"===e.type&&t.notify({reason:Tn.FROZEN})}),{capture:!0}),o=z(e,window,"beforeunload",(()=>{t.notify({reason:Tn.UNLOADING})})).stop;return()=>{n(),o()}}))}(t),c=!t.sessionStoreStrategyType||bt()||$n()?function(e){const t="1"===jn(e)?{}:void 0;return{findTrackedSession:()=>t,expireObservable:new j}}(t):Un(t,o),{stop:u}=ko(e,t,i,a,c);s.push((()=>u())),Qn(t,r),function(e,t){if(!e.forwardErrorsToLogs)return{stop:_};const n=new j,{stop:o}=no(n),r=n.subscribe((e=>{t.notify(0,{rawLogsEvent:{message:e.message,date:e.startClocks.timeStamp,error:lt(e),origin:st,status:ct.error},messageContext:e.context})}))}(t,r),function(e,t){const n=zn(e.forwardConsoleLogs).subscribe((e=>{var n;const o={rawLogsEvent:{date:Oe(),message:e.message,origin:nt,error:e.error&&lt(e.error),status:Jn[e.api]},messageContext:null===(n=e.error)||void 0===n?void 0:n.context,domainContext:{handlingStack:e.handlingStack}};t.notify(0,o)}))}(t,r),function(e,t){const n=Sn(e,e.forwardReports).subscribe((e=>{let n,o=e.message;const r="deprecation"===e.originalError.type?ct.warn:ct.error;var s,i;r===ct.error?n=lt(e):e.stack&&(o+=` Found in ${s=e.stack,null===(i=/@ (.+)/.exec(s))||void 0===i?void 0:i[1]}`),t.notify(0,{rawLogsEvent:{date:Oe(),message:o,origin:it,error:n,status:r}})}))}(t,r);const{handleLog:l}=ro(r);if(Hn(c,t,r,n,i),bt())!function(e){const t=ht();e.subscribe(1,(e=>{t.send("log",e)}))}(r);else{const{stop:e}=function(e,t,n,o,r){const s=wo(e,{endpoint:e.logsEndpointBuilder,encoder:So()},e.replica&&{endpoint:e.replica.logsEndpointBuilder,encoder:So()},n,o,r.expireObservable);return t.subscribe(1,(e=>{s.add(e)})),s}(t,r,i,a,c);s.push((()=>e()))}var d;return{handleLog:l,getInternalContext:(d=c,{get:e=>{const t=d.findTrackedSession(e);if(t)return{session_id:t.id}}}).get,stop:()=>{s.forEach((e=>e()))}}}));!function(e,t,n){const o=e[t];o&&!o.q&&o.version&&r.warn("SDK is loaded more than once. This is unsupported and might have unexpected behavior."),e[t]=n,o&&o.q&&o.q.forEach((e=>c(e,"onReady callback threw an error:")()))}(m(),"DD_LOGS",xo)})();